<form
	e2e="search-section"
	class="audit-form form-horizontal d-flex flex-column flex-xxxl-row align-items-start mb-1"
	ngNativeValidate
	(submit)="submit()">

	<div class="col-xxxl-10 p-0">
		<div class="d-flex flex-column flex-xxxl-row align-items-xxxl-center mb-3">
			<label
				for="search"
				class="col-sm-2 col-xxl-1 p-1 col-form-label">

				<b>
					Search:
				</b>
			</label>
			<div class="form-group d-flex flex-column flex-xxxl-row flex-wrap align-items-start w-100 mb-0 pl-2 pr-2">
				<div class="input-group">
					<div class="input-group-prepend">
						<i class="fa fa-search input-group-text"></i>
					</div>

					<input
						e2e="search"
						type="text"
						name="search"
						id="search"
						class="form-control auto-height"
						placeholder="Search for ..."
						minlength="3"
						[disabled]="!params.searchTypes || !params.searchTypes.length"
						(ngSubmit)="submit()"
						[(ngModel)]="params.search">

					<div class="input-group-append">
						<dropdown-item-multi-picker
							e2e="search-criteria"
							class="inline-block"
							placeholder="All"
							[search]="false"
							[data]="searchOptions"
							(paramsChanged)="searchFileNameChanged($event)">
						</dropdown-item-multi-picker>
					</div>
					<div class="input-group-append">
						<dropdown-item-picker
							e2e="search-criteria-mode"
							class="inline-block"
							[search]="false"
							[withRadioBtn]="true"
							[fixedWidth]="false"
							[data]="searchModes"
							(paramsChanged)="searchModeChanged($event[0].value)">
						</dropdown-item-picker>
					</div>
				</div>
			</div>
		</div>

		<div class="d-flex flex-column flex-xxxl-row align-items-start">
			<label class="col-sm-2 col-xl-1 p-1 pt-xxxl-3 col-form-label">
				<b>
					Filter by:
				</b>
			</label>
			<div>
				<div class="d-flex flex-wrap flex-column flex-xl-row align-items-start align-items-xl-center w-100">
					<div class="form-group d-inline-flex m-0 p-2">
						<dropdown-item-multi-picker
							e2e="source-app-dropdown"
							class="w-100"
							#sourceApplications
							placeholder="All Sources"
							placeholderEmpty="Select Sources"
							multiple="true"
							[fixedWidth]="true"
							[dataObservable]="sourceApplicationsSubj"
							(paramsChanged)="sourceChanged($event)">
						</dropdown-item-multi-picker>
					</div>

					<span
						class="d-none bold separator"
						[class.d-xl-none]="isEventTypesDropdownHidden"
						[class.d-xxl-inline-block]="!isEventTypesDropdownHidden">

						/
					</span>

					<div
						class="form-group m-0 p-2"
						[class.d-none]="isEventTypesDropdownHidden"
						[class.d-inline-flex]="!isEventTypesDropdownHidden">

						<dropdown-item-picker
							e2e="event-type-dropdown"
							#eventTypes
							class="inline-block"
							placeholder="All Event Types"
							[disabled]="loading || !params.sourceApplication || params.sourceApplication.length > 1 || sourceApplications.loading"
							(paramsChanged)="eventTypeChanged($event[0].value)">
						</dropdown-item-picker>
					</div>

					<div
						class="dropdown-select-backdrop"
						[class.open]="open"
						(click)="close()">
					</div>

					<div class="d-flex flex-column flex-xl-row align-items-start align-items-xl-center relative">
						<dropdown-item-picker
							e2e="date-range-column-type"
							class="inline-block p-2"
							[search]="false"
							[withRadioBtn]="true"
							[fixedWidth]="true"
							[disabled]="loading"
							[data]="dateRangeColumnTypes"
							(paramsChanged)="dateRangeColumnTypeChanged($event[0].value)">
						</dropdown-item-picker>
						<span class="d-none d-xl-inline-block pl-1 pr-1 bold">=</span>
						<material-date-range
							class="date-range p-2"
							[data]="dates"
							[exclude]="exclude"
							[defaultData]="defaultDates"
							(valuesChanged)="applyDates($event)">
						</material-date-range>
					</div>

					<div class="form-group form-check m-0 p-2 nowrap-text small">
						<label>
							<input
								e2e="with-errors-only"
								class="mr-1"
								type="checkbox"
								name="withErrorsOnly"
								[(ngModel)]="params.withErrorsOnly">

							<b>With Errors Only</b>
						</label>
					</div>
				</div>

				<div class="pl-2 pr-2">
					<date-range-ui
						[dateRange]="params.dateRange"
						[dateFrom]="params.dateFrom"
						[dateTo]="params.dateTo">
					</date-range-ui>
				</div>
			</div>
		</div>
	</div>

	<div class="btn-group align-self-xl-start mt-4 mt-xxxl-0 pl-xxxl-2">
		<button
			e2e="apply"
			type="submit"
			class="btn btn-primary rounded"
			[disabled]="loading">

			Search
		</button>
	</div>
</form>
